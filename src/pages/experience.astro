---
import Layout from '@/layouts/Layout.astro'
import { portfolioData } from '@/data/portfolio'

const { experience } = portfolioData

// Calculate total years at each company
const calculateDuration = (period: string) => {
  const [start, end] = period.split(' â€“ ')
  const startYear = parseInt(start.split(' ')[1])
  const endYear = end === 'Present' ? new Date().getFullYear() : parseInt(end.split(' ')[1])
  return endYear - startYear + 1
}

const timelineData = experience.map((job, index) => ({
  ...job,
  duration: calculateDuration(job.period),
  isActive: job.period.includes('Present'),
  color: index % 4 === 0 ? 'primary' : index % 4 === 1 ? 'secondary' : index % 4 === 2 ? 'accent' : 'info'
}))
---

<Layout title="Experience - Nilushan Silva" description="Explore my professional journey spanning 15+ years in software development, from junior developer to senior cloud engineer.">
  <!-- Page Header -->
  <section class="hero bg-gradient-to-r from-primary/10 to-secondary/10 py-20">
    <div class="hero-content text-center">
      <div class="max-w-3xl">
        <h1 class="text-4xl lg:text-5xl font-bold mb-6 text-base-content">
          Professional Experience
        </h1>
        <p class="text-lg text-base-content/70">
          My journey through the world of software development, cloud engineering, and technical leadership.
        </p>
      </div>
    </div>
  </section>

  <!-- Experience Timeline -->
  <section class="py-16 lg:py-24">
    <div class="container mx-auto px-4">
      <div class="max-w-5xl mx-auto">
        {timelineData.map((job, index) => (
          <div class="relative">
            <!-- Timeline Line -->
            {index < timelineData.length - 1 && (
              <div class="absolute left-8 top-32 w-0.5 h-full bg-base-300 hidden lg:block"></div>
            )}
            
            <div class="flex flex-col lg:flex-row gap-8 mb-16">
              <!-- Timeline Dot & Period -->
              <div class="flex-shrink-0 lg:w-64">
                <div class="flex items-center gap-4 lg:justify-end">
                  <div class="hidden lg:block text-right">
                    <div class={`badge badge-${job.color} badge-lg mb-2`}>
                      {job.duration} year{job.duration > 1 ? 's' : ''}
                    </div>
                    <p class="text-sm text-base-content/70 font-mono">
                      {job.period}
                    </p>
                    {job.isActive && (
                      <div class="badge badge-success badge-sm mt-1">Current</div>
                    )}
                  </div>
                  <div class={`w-16 h-16 bg-${job.color}/10 rounded-full flex items-center justify-center border-4 border-${job.color} relative`}>
                    <span class="text-2xl font-bold text-{job.color}">
                      {job.company.split(' ').map(word => word[0]).join('').slice(0, 2)}
                    </span>
                    {job.isActive && (
                      <div class="absolute -top-1 -right-1 w-4 h-4 bg-success rounded-full border-2 border-base-100 animate-pulse"></div>
                    )}
                  </div>
                  <div class="lg:hidden">
                    <div class={`badge badge-${job.color} badge-lg mb-2`}>
                      {job.duration} year{job.duration > 1 ? 's' : ''}
                    </div>
                    <p class="text-sm text-base-content/70 font-mono">
                      {job.period}
                    </p>
                    {job.isActive && (
                      <div class="badge badge-success badge-sm mt-1">Current</div>
                    )}
                  </div>
                </div>
              </div>
              
              <!-- Job Details -->
              <div class="flex-1">
                <div class="card bg-base-100 shadow-xl hover:shadow-2xl transition-all duration-300 group">
                  <div class="card-body">
                    <div class="flex flex-col sm:flex-row sm:items-start sm:justify-between mb-4">
                      <div>
                        <h3 class="card-title text-2xl group-hover:text-{job.color} transition-colors">
                          {job.title}
                        </h3>
                        <h4 class="text-lg font-semibold text-base-content/80 mt-1">
                          {job.company}
                        </h4>
                        <p class="text-base-content/60 flex items-center gap-2 mt-1">
                          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="h-4 w-4">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M15 10.5a3 3 0 11-6 0 3 3 0 016 0z" />
                            <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1115 0z" />
                          </svg>
                          {job.location}
                        </p>
                      </div>
                      <div class="flex flex-wrap gap-2 mt-4 sm:mt-0">
                        <div class={`badge badge-${job.color} badge-lg`}>
                          {job.type === 'full-time' ? 'Full-time' : 'Contract'}
                        </div>
                      </div>
                    </div>
                    
                    <!-- Key Highlights -->
                    <div class="mb-6">
                      <h4 class="font-semibold text-base-content mb-4 flex items-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="h-5 w-5 text-success">
                          <path stroke-linecap="round" stroke-linejoin="round" d="M11.48 3.499a.562.562 0 011.04 0l2.125 5.111a.563.563 0 00.475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 00-.182.557l1.285 5.385a.562.562 0 01-.84.61l-4.725-2.885a.563.563 0 00-.586 0L6.982 20.54a.562.562 0 01-.84-.61l1.285-5.386a.563.563 0 00-.182-.557l-4.204-3.602a.563.563 0 01.321-.988l5.518-.442a.563.563 0 00.475-.345L11.48 3.5z" />
                        </svg>
                        Key Achievements
                      </h4>
                      <div class="grid lg:grid-cols-2 gap-4">
                        {job.highlights.map((highlight) => (
                          <div class="flex items-start gap-3 p-3 rounded-lg bg-base-200/50 hover:bg-base-200 transition-colors">
                            <div class="flex-shrink-0 w-2 h-2 bg-{job.color} rounded-full mt-2"></div>
                            <div>
                              <h5 class="font-medium text-base-content text-sm mb-1">
                                {highlight.title}
                              </h5>
                              <p class="text-xs text-base-content/70 leading-relaxed">
                                {highlight.description}
                              </p>
                            </div>
                          </div>
                        ))}
                      </div>
                    </div>
                    
                    <!-- Technologies -->
                    <div class="mb-4">
                      <h4 class="font-semibold text-base-content mb-3 flex items-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="h-5 w-5 text-info">
                          <path stroke-linecap="round" stroke-linejoin="round" d="M17.25 6.75L22.5 12l-5.25 5.25m-10.5 0L1.5 12l5.25-5.25m7.5-3l-4.5 16.5" />
                        </svg>
                        Technologies & Tools
                      </h4>
                      <div class="flex flex-wrap gap-2">
                        {job.technologies.map((tech) => (
                          <div class="badge badge-outline hover:badge-{job.color} transition-colors cursor-default">
                            {tech}
                          </div>
                        ))}
                      </div>
                    </div>
                    
                    <!-- Impact Metrics (if available) -->
                    {job.company === 'Zimi Ltd' && (
                      <div class="mt-6">
                        <h4 class="font-semibold text-base-content mb-3 flex items-center gap-2">
                          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="h-5 w-5 text-warning">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 013 19.875v-6.75zM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V8.625zM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V4.125z" />
                          </svg>
                          Impact Metrics
                        </h4>
                        <div class="stats stats-horizontal shadow bg-base-200 w-full">
                          <div class="stat place-items-center">
                            <div class="stat-title text-xs">IoT Devices</div>
                            <div class="stat-value text-primary text-lg">55K+</div>
                            <div class="stat-desc">Managed</div>
                          </div>
                          <div class="stat place-items-center">
                            <div class="stat-title text-xs">Cost Reduction</div>
                            <div class="stat-value text-success text-lg">50%</div>
                            <div class="stat-desc">Infrastructure</div>
                          </div>
                          <div class="stat place-items-center">
                            <div class="stat-title text-xs">Uptime</div>
                            <div class="stat-value text-warning text-lg">99.999%</div>
                            <div class="stat-desc">Achieved</div>
                          </div>
                          <div class="stat place-items-center">
                            <div class="stat-title text-xs">Latency</div>
                            <div class="stat-value text-info text-lg">-40%</div>
                            <div class="stat-desc">Improvement</div>
                          </div>
                        </div>
                      </div>
                    )}
                  </div>
                </div>
              </div>
            </div>
          </div>
        ))}
      </div>
    </div>
  </section>

  <!-- Career Progression -->
  <section class="py-16 bg-base-200">
    <div class="container mx-auto px-4">
      <div class="max-w-4xl mx-auto text-center mb-12">
        <h2 class="text-3xl lg:text-4xl font-bold mb-4 text-base-content">
          Career Progression
        </h2>
        <p class="text-lg text-base-content/70">
          My growth from software engineer to senior cloud engineer and technical leader
        </p>
      </div>
      
      <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6">
        <div class="card bg-gradient-to-br from-primary/10 to-transparent shadow-lg">
          <div class="card-body text-center">
            <div class="w-16 h-16 bg-primary/20 rounded-full mx-auto mb-4 flex items-center justify-center">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="h-8 w-8 text-primary">
                <path stroke-linecap="round" stroke-linejoin="round" d="M17.25 6.75L22.5 12l-5.25 5.25m-10.5 0L1.5 12l5.25-5.25m7.5-3l-4.5 16.5" />
              </svg>
            </div>
            <h3 class="text-lg font-bold mb-2">Software Engineer</h3>
            <p class="text-sm text-base-content/70 mb-3">2008-2014</p>
            <p class="text-xs text-base-content/60">Building core components and learning software engineering fundamentals</p>
          </div>
        </div>
        
        <div class="card bg-gradient-to-br from-secondary/10 to-transparent shadow-lg">
          <div class="card-body text-center">
            <div class="w-16 h-16 bg-secondary/20 rounded-full mx-auto mb-4 flex items-center justify-center">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="h-8 w-8 text-secondary">
                <path stroke-linecap="round" stroke-linejoin="round" d="M18 18.72a9.094 9.094 0 003.741-.479 3 3 0 00-4.682-2.72m.94 3.198l.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0112 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 016 18.719m12 0a5.971 5.971 0 00-.941-3.197m0 0A5.995 5.995 0 0012 12.75a5.995 5.995 0 00-5.058 2.772m0 0a3 3 0 00-4.681 2.72 8.986 8.986 0 003.74.477m.94-3.197a5.971 5.971 0 00-.94 3.197M15 6.75a3 3 0 11-6 0 3 3 0 016 0zm6 3a2.25 2.25 0 11-4.5 0 2.25 2.25 0 014.5 0zm-13.5 0a2.25 2.25 0 11-4.5 0 2.25 2.25 0 014.5 0z" />
              </svg>
            </div>
            <h3 class="text-lg font-bold mb-2">Product Manager</h3>
            <p class="text-sm text-base-content/70 mb-3">2015-2017</p>
            <p class="text-xs text-base-content/60">Leading teams and driving product development for simulation software</p>
          </div>
        </div>
        
        <div class="card bg-gradient-to-br from-accent/10 to-transparent shadow-lg">
          <div class="card-body text-center">
            <div class="w-16 h-16 bg-accent/20 rounded-full mx-auto mb-4 flex items-center justify-center">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="h-8 w-8 text-accent">
                <path stroke-linecap="round" stroke-linejoin="round" d="M6.115 5.19l.319 1.913A6 6 0 008.11 10.36L9.75 12l-.387.775c-.217.433-.132.956.21 1.298l1.348 1.348c.21.21.329.497.329.795v1.089c0 .426.24.815.622 1.006l.153.076c.433.217.956.132 1.298-.21l.723-.723a8.7 8.7 0 002.288-4.042 1.087 1.087 0 00-.358-1.099l-1.33-1.108c-.251-.21-.582-.299-.905-.245l-1.17.195a1.125 1.125 0 01-.98-.314l-.295-.295a1.125 1.125 0 010-1.591l.13-.132a1.125 1.125 0 011.3-.21l.603.302a.809.809 0 001.086-1.086L14.25 7.5l1.256-.837a4.5 4.5 0 001.528-1.732l.146-.292M6.115 5.19A9 9 0 1017.18 4.64M6.115 5.19A8.965 8.965 0 0112 3c1.929 0 3.716.607 5.18 1.64" />
              </svg>
            </div>
            <h3 class="text-lg font-bold mb-2">Full Stack Engineer</h3>
            <p class="text-sm text-base-content/70 mb-3">2017-2020</p>
            <p class="text-xs text-base-content/60">Architecting and building scalable IoT platforms and cloud solutions</p>
          </div>
        </div>
        
        <div class="card bg-gradient-to-br from-info/10 to-transparent shadow-lg">
          <div class="card-body text-center">
            <div class="w-16 h-16 bg-info/20 rounded-full mx-auto mb-4 flex items-center justify-center">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="h-8 w-8 text-info">
                <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 15a4.5 4.5 0 004.5 4.5H18a3.75 3.75 0 001.332-7.257 3 3 0 00-3.758-3.848 5.25 5.25 0 00-10.233 2.33A4.502 4.502 0 002.25 15z" />
              </svg>
            </div>
            <h3 class="text-lg font-bold mb-2">Senior Cloud Engineer</h3>
            <p class="text-sm text-base-content/70 mb-3">2020-Present</p>
            <p class="text-xs text-base-content/60">Leading cloud architecture and mentoring teams on modern development practices</p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Skills Development -->
  <section class="py-16">
    <div class="container mx-auto px-4">
      <div class="max-w-4xl mx-auto text-center mb-12">
        <h2 class="text-3xl lg:text-4xl font-bold mb-4 text-base-content">
          Skills Evolution
        </h2>
        <p class="text-lg text-base-content/70">
          How my technical expertise has grown and evolved throughout my career
        </p>
      </div>
      
      <div class="grid lg:grid-cols-3 gap-8">
        <div class="card bg-gradient-to-br from-primary/5 to-transparent shadow-lg">
          <div class="card-body">
            <h3 class="card-title text-primary mb-4">Early Career (2008-2014)</h3>
            <ul class="space-y-2 text-sm">
              <li class="flex items-center gap-2">
                <div class="w-2 h-2 bg-primary rounded-full"></div>
                C++ and desktop application development
              </li>
              <li class="flex items-center gap-2">
                <div class="w-2 h-2 bg-primary rounded-full"></div>
                Game engine integration and simulation
              </li>
              <li class="flex items-center gap-2">
                <div class="w-2 h-2 bg-primary rounded-full"></div>
                Object-oriented design principles
              </li>
              <li class="flex items-center gap-2">
                <div class="w-2 h-2 bg-primary rounded-full"></div>
                MySQL and PHP web development
              </li>
            </ul>
          </div>
        </div>
        
        <div class="card bg-gradient-to-br from-secondary/5 to-transparent shadow-lg">
          <div class="card-body">
            <h3 class="card-title text-secondary mb-4">Growth Phase (2015-2017)</h3>
            <ul class="space-y-2 text-sm">
              <li class="flex items-center gap-2">
                <div class="w-2 h-2 bg-secondary rounded-full"></div>
                Team leadership and project management
              </li>
              <li class="flex items-center gap-2">
                <div class="w-2 h-2 bg-secondary rounded-full"></div>
                Cross-functional collaboration
              </li>
              <li class="flex items-center gap-2">
                <div class="w-2 h-2 bg-secondary rounded-full"></div>
                Product strategy and planning
              </li>
              <li class="flex items-center gap-2">
                <div class="w-2 h-2 bg-secondary rounded-full"></div>
                Quality assurance processes
              </li>
            </ul>
          </div>
        </div>
        
        <div class="card bg-gradient-to-br from-accent/5 to-transparent shadow-lg">
          <div class="card-body">
            <h3 class="card-title text-accent mb-4">Modern Era (2017-Present)</h3>
            <ul class="space-y-2 text-sm">
              <li class="flex items-center gap-2">
                <div class="w-2 h-2 bg-accent rounded-full"></div>
                Cloud architecture and microservices
              </li>
              <li class="flex items-center gap-2">
                <div class="w-2 h-2 bg-accent rounded-full"></div>
                TypeScript and React ecosystem
              </li>
              <li class="flex items-center gap-2">
                <div class="w-2 h-2 bg-accent rounded-full"></div>
                DevOps and CI/CD pipelines
              </li>
              <li class="flex items-center gap-2">
                <div class="w-2 h-2 bg-accent rounded-full"></div>
                IoT and real-time systems
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- CTA Section -->
  <section class="py-16 bg-gradient-to-r from-primary to-secondary">
    <div class="container mx-auto px-4 text-center">
      <div class="max-w-2xl mx-auto">
        <h2 class="text-3xl font-bold mb-4 text-primary-content">
          Ready for the Next Challenge
        </h2>
        <p class="text-lg text-primary-content/80 mb-8">
          With 15+ years of experience and a proven track record of delivering complex projects, 
          I'm excited to bring my expertise to your team and help drive your technical vision forward.
        </p>
        <div class="flex flex-col sm:flex-row gap-4 justify-center">
          <a href="/contact" class="btn btn-accent btn-lg">
            Let's Talk Opportunities
          </a>
          <a href="/projects" class="btn btn-outline btn-lg text-primary-content border-primary-content hover:bg-primary-content hover:text-primary">
            View My Projects
          </a>
        </div>
      </div>
    </div>
  </section>
</Layout>
